<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Uma Jornada no Nosso Tempo</title>
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="./assets/favicon/site.webmanifest">
    <link rel="icon" href="./assets/favicon/favicon.ico">
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <!-- Elementos do cursor personalizado -->
    <div class="cursor"></div>
    <div class="cursor-trail"></div>
    
    <!-- Elemento de áudio para a música tema -->
    <audio id="background-music" loop preload="auto" autoplay playsinline>
        <source src="./assets/audio/main-theme.wav" type="audio/wav">
        Seu navegador não suporta o elemento de áudio.
    </audio>

    <!-- Elementos de áudio para os sons dos botões -->
    <audio id="hover-sound" preload="auto">
        <source src="./assets/audio/hover.wav" type="audio/wav">
    </audio>
    <audio id="click-sound" preload="auto">
        <source src="./assets/audio/clicked.wav" type="audio/wav">
    </audio>

    <div id="game-container">
        <div id="menu-screen" class="screen active">
            <!-- Container de estrelas será preenchido via JavaScript -->
            <div class="stars"></div>
            
            <h1>Uma Jornada no Nosso Tempo</h1>
            <button id="start-button" onclick="stopMusicAndNavigate('pages/presentation-scene.html')">
                <span class="button-text">Iniciar Jornada</span>
            </button>
        </div>

        <div id="game-screen" class="screen">
            <video id="scene-video" width="100%"></video>
            <div id="choices-container">
                <button id="choice1" class="choice-button"></button>
                <button id="choice2" class="choice-button"></button>
            </div>
        </div>
    </div>

    <script src="./cursor-effects.js"></script>
    <script src="./game.js"></script>
    <script>
        // Reproduzir música de fundo ao carregar a página
        document.addEventListener('DOMContentLoaded', function() {
            const reqFSIfPossible = async () => {
                try {
                    const el = document.documentElement;
                    if (!document.fullscreenElement) {
                        if (el.requestFullscreen) await el.requestFullscreen();
                        else if (el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
                        else if (el.msRequestFullscreen) await el.msRequestFullscreen();
                    }
                } catch {}
            };
            reqFSIfPossible();
            const backgroundMusic = document.getElementById('background-music');
            try { backgroundMusic.volume = 0.7; backgroundMusic.setAttribute('playsinline',''); } catch {}
            
            // Tentativa de reprodução automática (pode ser bloqueada pelos navegadores)
            backgroundMusic.play().catch(function(error) {
                console.log("Reprodução automática bloqueada pelo navegador:", error);
                // Ativa som na primeira interação do usuário
                const tryEnable = () => {
                    reqFSIfPossible();
                    backgroundMusic.muted = false;
                    backgroundMusic.play().then(() => {
                        window.removeEventListener('pointerdown', tryEnable);
                        window.removeEventListener('keydown', tryEnable);
                        window.removeEventListener('touchstart', tryEnable);
                    }).catch(() => {});
                };
                window.addEventListener('pointerdown', tryEnable, { once: true });
                window.addEventListener('keydown', tryEnable, { once: true });
                window.addEventListener('touchstart', tryEnable, { once: true });
            });

            // Botão de tela cheia no topo direito
            if (!document.getElementById('fullscreen-btn')) {
                const fsBtn = document.createElement('button');
                fsBtn.id = 'fullscreen-btn';
                fsBtn.title = 'Tela cheia';
                fsBtn.className = 'music-control';
                fsBtn.textContent = '⛶';
                document.body.appendChild(fsBtn);

                const rootEl = document.documentElement;
                const isFS = () => !!(document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement);
                const reqFS = async () => {
                    try { if (rootEl.requestFullscreen) return await rootEl.requestFullscreen(); } catch {}
                    try { if (rootEl.webkitRequestFullscreen) return await rootEl.webkitRequestFullscreen(); } catch {}
                    try { if (rootEl.msRequestFullscreen) return await rootEl.msRequestFullscreen(); } catch {}
                };
                const exitFS = async () => {
                    try { if (document.exitFullscreen) return await document.exitFullscreen(); } catch {}
                    try { if (document.webkitExitFullscreen) return await document.webkitExitFullscreen(); } catch {}
                    try { if (document.msExitFullscreen) return await document.msExitFullscreen(); } catch {}
                };
                const refreshBtn = () => { fsBtn.textContent = isFS() ? '❐' : '⛶'; fsBtn.title = isFS() ? 'Sair da tela cheia' : 'Tela cheia'; };
                document.addEventListener('fullscreenchange', refreshBtn);
                document.addEventListener('webkitfullscreenchange', refreshBtn);
                document.addEventListener('msfullscreenchange', refreshBtn);
                fsBtn.addEventListener('click', async () => { if (isFS()) await exitFS(); else await reqFS(); refreshBtn(); });
                refreshBtn();
            }
        });
        
        // Função para parar a música e navegar para a próxima página
        function stopMusicAndNavigate(url) {
            const backgroundMusic = document.getElementById('background-music');
            backgroundMusic.pause();
            window.location.href = url;
        }
    </script>
</body>
</html> 